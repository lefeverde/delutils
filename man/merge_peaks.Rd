% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/peak_utils.R
\name{merge_peaks}
\alias{merge_peaks}
\title{Merge overlapping or nearby genomic peaks}
\usage{
merge_peaks(df, max_gap = 0)
}
\arguments{
\item{df}{A data frame with columns:
- `peak_id` (character): unique identifier per peak.
- `chrom` (character): chromosome/contig name.
- `start` (integer/numeric): 1-based start position.
- `end` (integer/numeric): 1-based end position (≥ start).}

\item{max_gap}{Integer (≥ 0). Maximum distance (in bp) between intervals to
consider them part of the same merged peak. `0` merges only overlapping
ranges; `100` merges ranges ≤100 bp apart, etc.}
}
\value{
A base data frame with columns:
  - `peak_id` (character): original peak ID.
  - `merged_peak` (character): merged interval ID `"chrom:start-end"`.
}
\description{
Collapses overlapping or nearby intervals using `GenomicRanges::reduce()`,
then returns a mapping of each original `peak_id` to its merged interval ID
in the form `"chrom:start-end"`.
}
\details{
Uses `GenomicRanges` and `IRanges` without attaching the packages. The
reduction uses `min.gapwidth = max_gap + 1`, so `max_gap = 0` collapses only
overlaps.
}
\examples{
df <- data.frame(
  peak_id = paste0("p", 1:4),
  chrom   = c("chr1","chr1","chr1","chr2"),
  start   = c(100, 180, 1000, 50),
  end     = c(200, 220, 1100, 80),
  stringsAsFactors = FALSE
)
merge_peaks(df, max_gap = 50)

}
